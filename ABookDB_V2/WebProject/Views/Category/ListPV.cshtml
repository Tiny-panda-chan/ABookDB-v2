@model WebProject.ViewModels.Book.CreateVM
@{
    SelectList cats = Model.CategoryCreateVM.AllCategories;
    if (Model != null ? Model.SelectedCategories != null : false)
    {
        foreach (var item in cats)
        {
            if (Model.SelectedCategories.Any(c => c == item.Text))
            {
                item.Selected = true;
            }
        }

    }
}

<label asp-for="@Model.CategoryCreateVM.AllCategories" class="control-label"></label>
<select id="cats" asp-for="@Model.SelectedCategories" class="form-control" asp-items="@(cats)" multiple multiselect-search="true">
</select>
<span asp-validation-for="@Model.CategoryCreateVM.AllCategories" class="text-danger"></span>
<input type="button" onclick="$('#AddCategoryModal').modal('show')" class="btn btn-secondary w-100 mt-2" value="Add category" />

<script>
    function AddCategory() {
            console.log($('#catName'));
            $.ajax({
                async: true,
                data: "slist=" + $('#cats').val() + "&catName=" + document.getElementById("catName").value,
                type: "POST",
                url: '/Category/AddCategory',
                success: function (partialView) {
                    console.log("partialView: " + partialView);
                    $('#categoryDiv').html(partialView);
                    $('#AddCategoryModal').modal('hide');
                    MultiselectDropdown(window.MultiselectDropdownOptions);
                }
            });
        }
</script>